set testdir [file dirname $argv0]
source $testdir/tester.tcl
set testprefix encryption

set ::timeout 60000

proc generate_keys {} {
  global test_encryption_key test_decryption_key
  set test_encryption_key "base64  -d <<'EOF'
  H4sIAAAAAAAAAQ+Qs4kRlAIB0bQGy8jzC3KzUuJq1P8yIyLy4rKSl6RiLpRiLpRSK
  U6JSNz4+LgRyMgA5OTk5OTk5OTk5OTk5OTk5OTk5MjEyMzAyMzAyM0MzAy0MzAyMz
  AyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMjMyMjMyMj
  MyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyPT1LW0tLT1L
  W0tLT1LW0tLT1LW0tLT1LW0tLT1LW0tLT1LW0tLTEtLTUtLTUtLTUtLTUtLTUtLTUt
  LTUtLTUtLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTEuLTEuLTEuLTEuL
  TEuLTEuLTEuLTEuLTEuLTEuLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTEtLTA
  yMjAyMjAyMjAyMjAyMjAyMjAyMjAmOTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk
  5OTk5OTk5OTk5OTk5OTk5OTk5OTk5Pz9PfHw5OTk5OTk5OTk5OTk5OTk5OTk5OTk
  5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5Pz9PfA5OTk5OTk5OTk5OTk5OTk5OTk5O
  Tk5OTk5OTk5OTk5OTk5OTk5OTk5Pz9PfQ5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk
  5OTk5OTk5OTk5OTk5OTk5OTk5OTk5Pz9Pfw5OTk5OTk5OTk5OTk5OTk5OTk5OTk5O
  Tk5OTk5OTk5OTk5OTk5OTk5OTk5Pz7T6R0AAAA"
  set test_decryption_key "base64  -d <<'EOF'
  H4sIAAAAAAAAAQ+Qs4kRlAIB0bQGy8jzC3KzUuJq1P8yIyLy4rKSl6RiLpRiLpRSK
  U6JSNz4+LgRyMgA5OTk5OTk5OTk5OTk5OTk5OTk5MjEyMzAyMzAyM0MzAy0MzAyMz
  AyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMzAyMjMyMjMyMj
  MyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyMjMyPT1LW0tLT1L
  W0tLT1LW0tLT1LW0tLT1LW0tLT1LW0tLT1LW0tLTEtLTUtLTUtLTUtLTUtLTUtLTUt
  LTUtLTUtLTEtLTEtLTEtLTEuLTEuLTEuLTEuLTEuLTEtLTEtLTEtLTEtLTEtLTEtLTEt
  LTEtLTEtLTEtLTEtLTEtLTEtLTkxMzAyMjAyMjAyMjAyMjAyMjAyMjAmOTk5OTk5OT
  5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OT
set testdir [file dirname $argv0]
source $testdir/fuzztester.tcl
set testprefix wal

set ::timeout 60000

proc wal_proc1 {} {
  set walargs {}
  lappend walargs "wal" "2"
  expr {0}
}

proc wal_proc2 {} {
  global walargs
  lappend walargs "wal" "4"
  uplevel execsql {
    BEGIN;
    INSERT INTO a VALUES(4);
    COMMIT;
  }
}

proc wal_proc3 {} {
  execsql {
    PRAGMA journal_mode = 'WAL';
  }
}

do_test wal-1.1 {
  execsql {
    CREATE TABLE a(x);
    INSERT INTO a VALUES(1);
  }
  execsql {SELECT count(*) FROM a}
} {1}

do_test wal-1.2 {
  execsql {
    create table b_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_1_2_1_c__c_2_1_2_1_1_1_1_1_2_1_2_1_2_1_1_1_1_1_2_1_2_1_2_1_2_1_1_1_2_1_1_1_2_1_1_2_2_1_1_c_2_1_2_1_1_c_2_1_1_1_2_2_1_2_1_2_1_2_1_1_c_1_2_1_2_c_2_1_2_2_2_2_2_1_2_1_2_1_1_1_c_1_2_1_1_2_c_1_1_1_1_2_1_1_1_2_1_2_1_1_1_c_1_1_c_2_1_2_1_c_2_1_2_2_2_2_1_1_2_c_2_1_1_2_1_2_c_2_1_2_2_2_1_1_1_1_1_c_2_2_1_2_1_2_2_2_1_1_1_2_1_2_1_2_1_1_1_2_1_1_1_2_2_2_1_1_1_1_1_1_1_c_2_1_2_1_1_2_1_2_1_1_c_1_1_1_1_2_2_2_1_2_1_2_1_1_1_2_1_2_1_2_1_1_1_1_1_2_1_1_c_2_1_2_2_1_2_1_2_1_1_c_2_1_1_1_2_1_c_1_1_2_1_1_c_1_1_c_2_1_2_2_2_1_1_2_c_2_1_1_1_2_1_c_2_1_2_1_1_1_c_1_1_1_1_2_2_2_1_1_1_2_1_1_1_2_c_2_1_2_2_1_2_2_1_1_1_2_c_2_1_1_c_2_1_c_1_1_2_c_2_1_2_2_2_2_2_2_2_1_2_2_1_2_1_c_2_1_c_1_1_c_2_2_1_2_1_1_1_c_2_1_1_1_1_1_1_c_1_2_1_c_2_1_2_2_2_1_2_2_1_1_2_c_2_c_2_1_2_2_c_1_3_1_2_1_2_1_1_2_c_2_1_2_1_c_1_2_1_1_2_1_c_1_2_1_1_1_1_1_1_c_2_2_1_1_1_2_1_2_1_2_2_2_1_c_2_2_c_2_2_2_c_2_2_c_2_1_2_2